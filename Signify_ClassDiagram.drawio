<sequenceDiagram>
    <actor name="User"/>
    <participant name="UserPreferences"/>
    <participant name="TTSSettings"/>
    <participant name="GoogleSpeechAPI"/>
    <participant name="GestureSettings"/>
    
    <message from="User" to="UserPreferences">updateSettings("TTS", ttsData)</message>
    <activate participant="UserPreferences"/>
    <message from="UserPreferences" to="TTSSettings">updateSettings(ttsData)</message>
    <activate participant="TTSSettings"/>
    <message from="TTSSettings" to="TTSSettings">validateSettings(ttsData)</message>
    
    <alt condition="settings valid">
        <message from="TTSSettings" to="GoogleSpeechAPI">validateAPISettings(ttsData)</message>
        <activate participant="GoogleSpeechAPI"/>
        <message from="GoogleSpeechAPI" to="TTSSettings">apiValidation</message>
        <deactivate participant="GoogleSpeechAPI"/>
        <message from="TTSSettings" to="UserPreferences">success</message>
        <message from="UserPreferences" to="User">success</message>
    </alt>
    <else condition="settings invalid">
        <message from="TTSSettings" to="UserPreferences">error</message>
        <message from="UserPreferences" to="User">error</message>
    </else>
    
    <deactivate participant="TTSSettings"/>
    <message from="User" to="UserPreferences">updateSettings("GESTURE", gestureData)</message>
    <message from="UserPreferences" to="GestureSettings">updateSettings(gestureData)</message>
    <activate participant="GestureSettings"/>
    <message from="GestureSettings" to="GestureSettings">validateSettings(gestureData)</message>
    
    <alt condition="settings valid">
        <message from="GestureSettings" to="UserPreferences">success</message>
    </alt>
    <else condition="settings invalid">
        <message from="GestureSettings" to="UserPreferences">error</message>
    </else>
    
    <deactivate participant="GestureSettings"/>
    <message from="UserPreferences" to="User">updateComplete</message>
    <deactivate participant="UserPreferences"/>
</sequenceDiagram>
